<view class="course-tasks-page">
  <!-- 课程头部 -->
  <view class="course-header" style="background: linear-gradient(135deg, {{coverColor}}, {{coverColor}}99);">
    <view class="course-title">{{courseTitle}}</view>
    <view class="course-term">{{courseTerm}}</view>
    <view class="course-description">{{courseDescription}}</view>
  </view>

  <!-- 任务统计 -->
  <view class="task-stats">
    <view class="stat-item">
      <view class="stat-number">{{tasks.length}}</view>
      <view class="stat-label">总任务</view>
    </view>
    <view class="stat-item">
      <view class="stat-number">{{completedCount}}</view>
      <view class="stat-label">已完成</view>
    </view>
    <view class="stat-item">
      <view class="stat-number">{{completionRate}}%</view>
      <view class="stat-label">完成率</view>
    </view>
  </view>

  <!-- 任务列表 -->
  <view class="tasks-section">
    <view class="section-header">
      <text class="section-title">个人任务</text>
      <text class="task-count">({{tasks.length}})</text>
    </view>
    
    <!-- 任务卡片列表 -->
    <view class="task-list">
      <view class="task-card" wx:for="{{tasks}}" wx:key="id">
       
        
        <!-- 任务内容 -->
        <view class="task-content">
          <!-- 任务标题和标签 -->
          <view class="task-header">
            <view class="task-title-wrapper">
              <!-- 大字标题 -->
              <text class="task-title">{{item.title || item.name}}</text>
              <van-tag type="primary" size="medium" custom-class="task-tag">个人任务</van-tag>
            </view>
          </view>

          <!-- 任务描述 -->
          <view class="task-desc">{{item.description}}</view>

        <!-- 指标网格 -->
<view class="metrics-grid">
  <!-- 截止日期 -->
  <view class="metric-item">
    <view class="metric-icon-wrapper">
      <van-icon name="clock-o" size="32rpx" color="#1989fa" />
    </view>
    <view class="metric-content">
      <text class="metric-label">截止日期</text>
      <text class="metric-value">{{item.deadlineText}}</text>
    </view>
  </view>

  <!-- 任务状态 -->
  <view class="metric-item">
    <view class="metric-icon-wrapper">
      <van-icon name="passed" size="32rpx" color="{{item.isCompleted ? '#07c160' : '#ff976a'}}" />
    </view>
    <view class="metric-content">
      <text class="metric-label">任务状态</text>
      <text class="metric-value {{item.statusClass}}">{{item.statusText}}</text>
    </view>
  </view>

  <!-- 完成率 -->
  <view class="metric-item">
    <view class="metric-icon-wrapper">
      <van-icon name="chart-trending-o" size="32rpx" color="{{item.isCompleted ? '#07c160' : '#ff976a'}}" />
    </view>
    <view class="metric-content">
      <text class="metric-label">完成率</text>
      <text class="metric-value green">{{item.isCompleted ? '100%' : '0%'}}</text>
    </view>
  </view>

  <!-- 热度指数 -->
  <view class="metric-item">
    <view class="metric-icon-wrapper">
      <van-icon name="fire-o" size="32rpx" color="#ee0a24" />
    </view>
    <view class="metric-content">
      <text class="metric-label">热度指数</text>
      <text class="metric-value orange">{{item.popularity || 66}}</text>
    </view>
  </view>

  <!-- 得分 -->
  <view class="metric-item">
    <view class="metric-icon-wrapper">
      <van-icon name="star-o" size="32rpx" color="#ffd700" />
    </view>
    <view class="metric-content">
      <text class="metric-label">得分</text>
      <text class="metric-value">{{item.score || '未评分'}}</text>
    </view>
  </view>
</view>

          <!-- 底部按钮 -->
          <view class="task-footer">
            <view class="footer-button gray-button" catchtap="onViewExcellentWork" data-id="{{item.id}}">
              <van-icon name="like-o" size="32rpx" color="#ffffff" />
              <text>查看优秀作业</text>
            </view>
            <view class="footer-button gradient-button" catchtap="onAiDiscussion" data-id="{{item.id}}">
              <van-icon name="chat-o" size="32rpx" color="#ffffff" />
              <text>AI互动讨论</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{!loading && tasks.length === 0}}">
      <image src="/images/empty-tasks.png" class="empty-image" mode="aspectFit"></image>
      <text class="empty-text">该课程暂无任务</text>
      <text class="empty-subtext">快去学习其他课程吧</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
</view>

